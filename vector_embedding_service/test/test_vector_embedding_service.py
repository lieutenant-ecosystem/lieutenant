from typing import Dict, Any, List

import aiohttp
import pytest

from src.models import Embedding, EmbeddingGet, EmbeddingQuery

BASE_URL: str ="http://0.0.0.0:8001"


@pytest.mark.asyncio
async def test_get_embeddings() -> None:
    url: str = f"{BASE_URL}/embeddings"
    json: Dict[Any, Any] = EmbeddingGet(input="The capital of France is Paris.",model="text-embedding-3-small").model_dump()

    async with aiohttp.ClientSession() as session:
        async with session.post(url, json=json) as response:
            assert response.status == 200

@pytest.mark.asyncio
async def test_upsert_embeddings() -> None:
    url: str = f"{BASE_URL}/database"
    text: str = "The capital of France is Paris."
    embeddings: List[float] = [ 0.04203098, 0.016338512, 0.030596081, 0.025197985, -0.02276678, -0.0034433468, -0.01655485, 0.014649033, 0.010435632, -0.009312746, 0.005150855, -0.025445225, -0.062016297, -0.013268603, -0.015524678, 0.021963246, -0.005624734, 0.02084036, 0.07314215, -0.02451807, 0.0024054495, -0.012619595, -0.038816847, 0.011877872, 0.06279923, 0.0049370946, -0.045368735, -0.008277425, 0.001466706, 0.038281158, 0.042237014, -0.024497468, -0.0031471725, 0.04180434, -0.023941176, -0.04083598, -0.034737367, -0.040856585, 0.019367216, 0.029895565, -0.0022779657, -0.011888174, 0.007978675, 0.012805026, -0.02740255, -0.029998582, -0.009853587, -0.03842538, -0.03288306, 0.026702033, 0.03776607, 0.005166308, 0.033707198, 0.032903664, -0.018419458, 0.005799863, 0.024559278, 0.010332616, 0.047305454, 0.013515844, 0.037292194, -0.009410612, 0.026887465, 0.002969468, -1.79958E-4, 0.034799177, -0.004252031, 0.03702435, 0.060244404, 0.05010752, -0.01294925, 0.01788377, -0.007535701, 0.0028999315, -0.009003695, -0.017904373, -0.005593829, -0.008349536, -0.03232677, -0.03041065, -0.03661228, -8.12467E-5, -0.021087602, -0.009503328, 0.009415763, -0.044956665, 0.028329704, 0.030451857, -0.023652727, -0.0451627, 0.0032656423, 0.013165586, -0.02433264, 0.028721169, -0.010971322, 0.020047128, 0.032780044, 0.0026964727, -0.06976318, 7.06311E-4, 0.01752321, -0.023384882, -0.030554874, 0.025939707, 0.024497468, 0.040094256, 0.01783226, -0.0054702084, 0.003626202, -0.039599776, -0.029524703, 0.009719664, 5.7528616E-4, 0.023343677, -0.048129592, -0.02962772, -0.021242127, -0.025610052, 0.028824186, -0.023941176, 0.031646855, 0.05093166, -0.047799937, 0.010183241, 0.010054469, -0.014412093, -0.00373437, -0.0030699098, 0.035273056, -0.03776607, 0.008684342, -0.02903022, 0.024229623, 0.033851422, 0.031955905, 0.016668167, 0.030699097, -0.017399589, -0.02024286, 0.008869773, 0.0060007465, 0.01409274, 0.022869797, 0.003590146, -0.025548242, -0.013289207, -0.040217876, 0.043432012, 0.009657853, -0.041515894, 0.043019943, -0.02342609, -0.0042494554, 0.015761618, -0.0032682177, -0.03799271, -0.014113343, 0.020768248, 0.005060715, 0.043267183, -0.040011846, 0.051590968, -0.0403415, -0.0043756515, 0.01174395, 0.030122202, -0.035746936, -0.021097904, 0.009601194, -0.0037652752, -0.026063327, 0.0063252505, 0.054351825, 0.022354713, 0.032203145, -0.026042724, -0.048005972, 0.04161891, -0.0012368491, -0.018646097, -0.02793824, -0.02806186, 0.01138339, 0.009405462, 0.06234595, 0.031708665, -0.010481991, -0.02464169, -0.014288473, 0.012114812, 0.03716857, -0.019768983, 0.061686642, -0.007958071, -0.0439677, 0.021159714, 0.034799177, 0.011970588, 0.012743216, -0.008133201, -0.01830614, 0.021005187, -0.010214146, 0.016111875, -0.019676266, 0.027690997, -0.011692441, -0.012382656, -0.015864635, -0.011249468, -1.3472706E-4, -0.005109648, -0.024950743, 0.00397646, 7.5846346E-4, 0.025136175, -4.809611E-4, 0.01060046, 0.0054186997, 0.023714537, 0.024312036, 0.014278171, 0.0031239938, -0.011805761, -0.056741823, 0.04738787, 0.06094492, 0.014267869, 0.006953655, -0.0045919875, 0.02060342, -0.03288306, 0.0011209549, -0.012629897, -0.032017715, 0.017595321, 0.01601916, 0.028782979, -0.035561506, 0.023323072, -0.0090449015, 0.022189885, 0.02909203, -0.0080559375, -0.012485673, -0.006114065, 0.022334108, 0.03692133, 0.004895888, 0.04209279, 0.056329753, -0.007844753, -0.0012091632, -0.004228852, -0.021448161, 0.056082513, -0.025960311, -0.028947806, -0.033748403, -0.020448895, 0.009039751, 0.0016598632, -0.003239888, -0.015359851, 0.02083006, 2.2792534E-4, -0.02264316, -0.027567377, -0.014113343, -0.010229599, 0.0076335673, -0.0025818662, -0.015277437, 0.0085813245, -0.019398121, 0.016214892, -0.016688772, -0.007772641, -0.017554116, 0.0355409, -0.026887465, 0.047305454, -0.012011794, 0.041412875, -0.052126653, -8.64056E-4, 0.042607874, 0.022334108, -0.01390731, 0.031708665, 0.021963246, 0.01969687, -0.019861698, -0.0032192846, -8.0482115E-4, -0.044173736, -0.0052487217, 0.0036777107, 0.026269361, -0.002429916, -0.02089187, 0.021860229, -0.006696112, 0.01053865, -0.04231943, 0.06477716, -0.0059646904, 0.050066315, 0.052003033, 0.008571023, -0.038631413, -0.029998582, 0.027443757, -0.034840386, -0.007582059, 0.04644011, -0.014123646, 0.0018053747, 0.029648323, -0.0059955954, 0.02342609, 0.008225916, 0.026475396, -0.0074429857, -2.2760342E-4, 0.015081705, 0.010548952, 0.025692467, -0.03714797, -0.022931607, -8.859471E-4, 0.010100828, 0.00448897, -0.011218563, -0.026104534, -0.021819023, 0.006088311, 0.039414346, 0.0018530202, -0.015081705, -0.031832285, 0.04487425, 0.009369406, 0.034057453, 0.0024041617, -0.024703503, 0.021551179, 0.024703503, 0.013855801, 0.0021131383, -0.027114103, -0.008534967, -0.009889642, -0.008210463, -0.026289966, 0.0019611882, 0.07009284, -0.023323072, -0.06518923, 0.038384173, -0.037848484, -0.04903614, -0.023920571, -0.050313555, -0.033089094, -0.002628224, 0.012784422, 0.005220392, -0.020201655, 0.05987354, -0.035252452, 0.0062119314, -0.0031626252, -0.021365747, 0.04112443, -0.027175913, 0.044256147, 0.023075832, 0.012794725, -0.018089803, -0.030142805, -0.016966917, 0.016544547, -0.027299533, 0.061315782, 0.014154551, 0.08220765, -0.043761667, -0.011671838, 0.03210013, -0.0049963295, 0.01360856, 0.032203145, 0.03762185, -0.07503766, 0.0032270108, 0.007726283, 0.01614278, -0.0065261335, -0.038322363, 0.02060342, -0.017677736, -0.03168806, -0.048335627, 0.07606783, 0.018151615, 0.027423153, 0.0041387123, 0.012629897, -0.032058924, -0.00463577, -0.057483546, 0.010064771, -0.010085375, 0.0024595333, 0.051838208, 0.06284043, -0.06992801, 0.022540143, -0.015215627, -0.0022019907, -0.0039301026, -0.046934593, 0.009441517, -0.024682898, -0.007958071, -0.01661666, -0.047882352, 0.0049370946, 0.030039787, -0.0010121431, -0.0023590918, 0.0043859533, 5.926703E-4, 0.0025767153, -0.007200896, 0.0080868425, 0.04623408, -0.034181077, 0.025362812, 0.018944846, -7.122667E-5, 0.0028767528, -0.016029462, -0.0373334, -0.017677736, 0.039311327, 0.013598258, -0.047346663, 0.046275284, -0.021005187, 0.0077983947, -0.021530574, -0.01855338, -0.00758721, 0.037312794, 0.025816087, 0.09073747, 0.00830833, 2.5255288E-4, 0.006005897, 0.060120784, 0.011507011, 0.028453324, 0.033562973, 0.025321605, 0.027011085, 0.015967652, -0.04023848, -0.047717523, -0.00794777, 0.044956665, 0.009384858, 0.01620459, -0.026083931, -0.0228904, -0.058266476, 0.016451832, -0.05385734, -0.023776349, -0.040671155, 0.010312012, -0.0024324914, -0.025094967, -0.08480368, -3.9725972E-4, 0.002964317, 0.038858052, -0.029977977, 0.021386351, 0.04384408, -0.013557051, -0.004458065, -0.005835919, 0.028247291, -0.007427533, -0.042772703, -0.016153082, -0.016060367, -0.05521717, -0.015947048, 0.015493773, 0.005629885, 0.009678457, 0.04120684, 0.060986128, 0.04915976, 0.025383415, -0.023508504, -0.011197959, 0.014164852, -0.048335627, 0.014236964, 0.018110408, -0.011537916, 0.009498177, -0.0234879, 0.008900678, -0.001619944, -0.029710133, 0.024971345, 0.016956616, -0.0049860277, 0.004864983, 0.02787643, -0.007896261, -0.008668889, -0.0045559313, 0.03166746, -0.05534079, 0.0068145813, -0.020984584, -0.011424597, -2.1070217E-4, -0.00879251, 0.001336647, -0.009956603, 0.049242176, 0.018058898, 0.042175204, -8.859471E-4, -0.002830395, 0.005346588, -0.012516579, -0.0355409, -0.018563682, 0.0047490885, -0.048994936, -0.020665232, -0.033892628, -0.02089187, 0.056494582, -0.04623408, -0.043555632, -0.005150855, 0.0068145813, -0.028206084, -0.001043692, 0.04256667, -0.0028638756, 0.029771943, 0.027979447, 0.039105292, 0.0054238504, 0.0036390792, 0.0043756515, 0.007396628, 2.636594E-4, -0.012022097, -0.03451073, 0.019068466, 0.042051584, 0.019119974, -0.012660802, 0.01258869, 0.010724081, -0.030554874, 0.0019405847, -0.0050735925, 0.06040923, 0.0144533, 0.0024144633, 0.01252688, -0.053939756, -0.05558803, 0.021386351, -0.0036777107, 0.014288473, -0.016513642, -0.057071477, -0.019727776, 0.06197509, 0.007061823, -0.0076335673, 0.0024530948, 0.0026578414, 0.006448871, -0.023034625, -0.024682898, -0.011877872, 6.724281E-5, 0.005980143, -0.025754277, -0.04244305, 0.023343677, -0.013958817, 0.026269361, -0.027258325, 0.013721879, 0.005614432, 0.011187658, -0.0010585007, 0.005233269, 0.012856535, -0.0046203174, 0.010466538, -9.27154E-4, 0.02981315, -0.0055577727, 0.02053131, -0.0056762425, 0.030184012, -0.02715531, 0.008694644, -0.017111141, 0.017358383, 0.010590158, 0.011589425, 0.02198385, -0.028721169, -0.015514376, 0.020974282, -0.015215627, 0.010471689, -0.02113911, -0.033089094, 0.024600485, -0.00239386, 0.009256087, -0.03992943, 0.043885287, 0.0047207586, -0.008663738, 0.019799888, -0.021365747, -9.142768E-4, 0.026289966, 0.04060934, 0.0070360685, -0.013289207, 0.030266427, 0.029009616, 0.004908765, 0.0042237015, 0.0046228925, 0.021963246, 0.03144082, -0.0012387807, -0.024085399, 0.06646664, -0.02692867, -0.026042724, 0.03298608, -0.017214159, -0.033336334, 0.0036081742, -0.033562973, 0.0059955954, 0.053568896, 0.030039787, -0.032141335, -0.0025870171, 0.023220055, 0.03360418, -0.03257401, -0.010507745, -0.0074584386, -7.2691444E-4, -0.025424622, 0.01041503, 0.04565718, 0.026166344, -0.012320845, 0.039022878, -0.003239888, 0.008545269, 0.01994411, 0.05023114, 0.027608585, -0.012908043, -0.016008858, -0.0046718256, -0.023879364, 0.040382706, 0.024662295, -0.038095724, 0.037724864, 0.013196492, 0.013134681, 0.018821225, -0.007396628, -1.628958E-4, -0.032079525, 0.00412326, 0.011403994, 0.005047838, -0.010095676, -0.006876392, 0.009961754, -0.009467272, -0.04161891, -0.05047838, -0.026331171, 0.006299496, -0.0023861337, 0.042607874, 8.093281E-4, -0.009848435, 0.024085399, -0.025424622, -0.0072833095, -0.009204579, -0.03294487, -0.025795484, 0.028432721, 0.010250202, -0.005009207, 0.011033132, 0.017554116, 0.0076696235, -0.009982358, -0.026104534, -0.010775589, 0.0056762425, 0.017214159, 0.017162649, -0.0024827123, -0.0027608585, -0.043308392, 0.0011995054, -0.028638756, 0.025424622, 0.006546737, -0.031152373, 0.033624783, 0.049530625, -0.003185804, -0.016606357, -0.02223109, -0.020191353, -0.030657891, 0.0030080995, 0.018275235, -0.023570314, 0.019521741, -0.012145717, -0.0059904447, -0.003891471, -0.00409493, -0.057565957, 1.7287557E-4, 0.01114645, -0.03222375, -0.012980156, -0.0083340835, -0.020521007, 0.012217829, -0.0018027993, -0.022972815, -0.015874935, -0.021695402, 0.015545282, -0.034778576, -8.6920685E-4, 0.009766022, -0.0071030296, -0.0650244, 0.014082438, -0.03632383, -0.03022522, 0.017574718, 0.005562924, 0.01162033, 0.02746436, -0.0077983947, -0.018203123, 0.07965282, -0.05455786, -0.007334818, -0.023323072, 0.009400311, -0.0042133997, -0.0055268677, -0.0063664573, 0.020263465, -0.014669636, 0.041886754, -0.029916167, 0.0013327838, -0.0511789, -0.030966941, 0.010461387, 0.022663763, -0.02077855, 0.014793256, 0.024126606, -0.033645388, 0.008988243, 0.022251695, 0.0204695, -0.017018426, -0.041639514, -9.374557E-4, -0.029298065, 0.028927203, 0.016874202, -0.0066343015, -0.027670395, 0.03980581, 0.010847701, 0.022128073, 0.007267857, -0.029009616, -0.03263582, 0.03292427, -0.020139843, 0.042525463, 0.047717523, 0.010775589, 0.018522475, -0.0076335673, 0.026331171, -0.011280373, 0.020727042, 0.015164118, 0.006654905, 0.011610027, -0.03360418, -0.0031471725, 0.004437462, -0.008813113, 0.028473929, 0.03185289, -0.041268654, 0.038775638, 0.006608547, -0.002502028, 0.024415053, 0.005367191, 0.004800597, -0.015081705, 0.048582867, -0.04590442, -0.012444466, -0.011125848, 0.02806186, 0.0017113717, 0.027505567, 0.02113911, -0.018275235, -0.010888908, -0.004409132, -0.03317151, -0.0071287835, -0.0031883793, -0.0228904, -0.026413586, -0.041165635, -0.037230384, 0.039167102, 0.013948516, -0.032017715, 0.004120684, 0.018161915, 0.0059595397, 0.02915384, -0.0047722673, 0.008143502, -0.015699808, -0.05373372, -0.009261237, 0.013144983, 0.011702743, -0.0026913218, -0.012619595, -0.012959552, -0.0019895178, -0.026228156, -0.0034459222, 0.018409157, 0.02787643, 0.026434189, 0.0034948552, -0.015998557, -0.048253212, 0.011053735, -0.012341449, 0.043555632, -0.009127315, -0.038487192, -0.0204695, 0.034593143, 0.025568845, -0.014267869, 0.018120708, 0.0055371695, -0.031461425, 0.03286246, -0.012320845, -0.03197651, 0.013557051, -0.019954413, -0.01349524, 0.01764683, 0.06811491, -0.03463435, -0.008452553, 0.052456312, -0.029833755, 0.03047246, -0.0716999, 0.049242176, -0.046151664, -0.04660494, 0.026207551, 0.014350283, -0.0057122987, 0.039744, -0.00463577, 0.0013353592, -0.008818264, 0.03644745, -0.0050272346, -0.017615926, -0.019923508, 0.0019908056, -0.03127599, -0.009230332, -0.027773412, 0.01601916, 0.0034716765, 0.013000758, 0.007803546, 0.0037626997, 0.04054753, 0.0040202425, 0.034016248, -0.010281107, 0.07425473, 0.012217829, 0.011373089, -0.03708616, -0.020685835, -0.016348815, 0.018501872, 0.02120092, -0.006953655, 0.015019894, -0.019284802, -0.010492292, -0.022395918, 0.016936012, 0.0018440062, 3.3770295E-4, -0.022787383, 0.020675533, -0.01650334, 0.02655781, 0.02311704, 0.043596838, -0.014968385, -0.02270497, -0.01114645, 0.013927912, -0.015225928, -0.040094256, 0.040671155, 0.012650501, 0.009503328, -0.0024363545, 0.010317164, 3.9017727E-4, -0.0014692815, -0.0041696173, -0.010796193, 4.7484448E-4, -0.012362053, -0.0027248024, -0.00728846, -0.011816062, 0.03547909, 0.031152373, 0.017502606, -0.02011924, 0.011167054, 8.576174E-4, 0.0035566655, -0.0028587247, 0.046810973, -0.04240184, -0.059997164, 0.037065554, 0.010682873, -0.014000025, -0.009930849, -0.01794558, -0.010651968, 0.023075832, -0.03999124, -0.07091697, 0.008704945, -0.020366482, 0.0022934184, -0.011867571, -0.020438593, 0.023446694, 0.02806186, -0.00397646, -0.02674324, -0.015380454, -0.03034884, 0.009173674, 0.0073554213, -0.0026938973, 0.020376783, -0.015267135, 0.0047181835, -0.010631366, -0.0049345195, -0.0033094245, -0.019233294, -0.008833717, -0.03739521, 0.026908068, -0.012835931, 0.012598992, 0.012444466, 0.0062479875, -0.02077855, 0.008390743, -0.0026475396, -7.526687E-4, -0.033521768, -0.014535714, 0.022663763, -0.010528348, -7.8421773E-4, 0.027237723, 0.034407713, -0.0047078817, -0.05142614, -0.017234761, 0.011270071, -0.031420216, -0.04011486, -0.03300668, -0.004666675, -0.010548952, 0.0026887464, 0.014401792, 0.040279686, 0.008452553, 0.026949275, -0.03226496, -0.002717076, 0.030328237, 0.02486833, 0.012403259, -0.006876392, 0.020685835, -0.0019251321, 0.01343343, 0.015668903, 0.010188391, -0.022807987, -0.0078705065, 0.0056762425, 0.035211246, 0.012609294, 0.0445858, 0.00837014, -0.015493773, 0.031152373, 0.033707198, -0.03650926, -0.047799937, 0.021087602, -0.020860964, -0.015164118, -0.008411347, 0.015339247, 0.04137167, 0.008014731, -0.016338512, 0.059173025, 0.022684367, -0.010533499, -0.013289207, 0.010322314, 0.039125897, 0.033192113, -0.027629187, 0.029071428, -0.01830614, 0.011929381, -0.0029437137, -0.037910294, 2.2969596E-4, -0.008710097, -0.019779284, 0.019233294, 0.033872023, 0.008874924, 0.017976485, -0.024188416, 0.02113911, 0.014185456, -0.009616647, -0.010682873, 0.010610762, 0.041165635, -0.03329513, -0.043638047, -0.003239888, -0.0021749486, -0.019954413, -0.018038295, -0.012403259, -0.009132466, -0.0056659407, 0.0162561, 0.015854333, -0.018058898, -7.256267E-4, -0.022251695, 0.009472423, -0.019439328, -0.0037498227, -0.025383415, 0.03444892, 0.013721879, -0.01783226, 0.02264316, 0.030245822, -0.008926433, -0.027114103, 0.015741013, 0.0487889, -0.00373437, 0.024909535, 0.008050786, -0.008426799, -0.002915384, -0.012217829, 0.011455502, -0.009740267, -0.007221499, -0.004973151, 0.02674324, 0.047058214, -0.0066343015, 0.006510681, -0.002722227, 0.013237698, -0.06259319, -0.022498935, 0.0040562986, -0.017245064, -0.006577642, -0.016183987, 0.007968373, 0.012392958, 0.019253897, 0.0035283358, 0.018718207, 0.012609294, -0.04462701, -0.024106003, 0.023158245, 0.024909535, -0.0031420218, 0.0036107495, 0.04569839, -8.878787E-4, -0.026969878, 0.004329294, 0.026887465, -0.02981315, 0.0016341088, 0.015473169, -0.019872, 0.0051276763, -0.0015787372, -0.0023552286, 0.009147919, 0.02210747, -0.005974992, 0.035149436, 0.01108464, -0.021530574, -5.344012E-4, -0.018398855, 0.0017937854, 0.026722638, 0.006654905, 0.042607874, 0.013423129, 0.03172927, -4.6228926E-4, -0.013144983, 0.009843284, -0.008534967, -0.02661962, -0.006737319, 0.038919862, -0.021716006, 0.0361384, 0.033995643, 0.012660802, -0.029174443, 0.009029449, 0.00337381, 0.007978675, -0.0042958134, -0.017142046, -0.040259086, 0.058637336, -0.01210451, 0.037065554, 0.0045250263, -0.015473169, 0.012362053, -0.05562924, -0.0076490203, 0.011764553, 0.02981315, 0.02192204, -0.0058616735, -0.0036184757, -0.01373218, -0.01957325, 6.564121E-4, 0.061521817, -0.036715295, 0.00891613, -0.027114103, -0.00939516, -0.017306874, -0.015205325, -0.027958842, 0.018594587, 0.007695378, -0.021592386, 0.0026166346, -0.04569839, -0.029854357, 3.0711974E-4, -0.022931607, -0.017543813, 0.048706487, 0.007762339, 0.03591176, -0.032965474, -0.02523919, -0.001686905, -0.0029231103, -0.012372354, 0.0019611882, 0.004318992, 0.0027479813, 0.004486395, 0.012908043, -0.026763843, 0.03968219, -0.026310569, 0.008323782, 0.007479042, 0.027134705, 0.032491595, 0.010142034, -0.004823776, -0.03469616, 0.015771918, -0.0032785195, 0.057771992, 0.02090217, 0.039167102, 0.009297294, 0.03292427, 0.007376025, -0.028473929, 0.008668889, -0.03162625, 0.032120734, -0.010672572, -0.03920831, 0.02486833, -0.030802114, -0.0057535055, -0.004339596, 0.03830176, 0.01042018, -0.025136175, 0.010543801, 0.03317151, 0.02686686, -0.017018426, -0.016771184, 0.031358406, -0.0114452, -0.045451146, -0.0025844416, 0.0031986812, 0.03341875, -0.006629151, -6.9665315E-4, -0.019140579, -0.004684703, -0.0064952285, -0.021654196, 0.013526146, 0.03650926, 0.01343343, 0.025301002, 0.022004453, -0.008045636, -0.023446694, 0.009008846, -0.016915409, -0.012372354, -0.006696112, -0.016843297, 0.014844765, 0.00397646, -0.0023990108, -0.013536448, 0.011434899, 0.023776349, -0.021839626, -0.010981623, 0.022869797, -0.031337805, 0.017111141, -0.048005972, -0.007885959, 0.024064796, -0.029998582, 0.04231943, 0.034098662, 0.03022522, -0.025486432, -1.3118585E-4, -0.04928338, -0.0026346624, -0.030431254, 0.028721169, 0.011733648, 0.021901436, -0.038322363, -0.008148653, 0.015617393, -0.0053414367, -0.021819023, -0.016894806, 0.02276678, -0.014473903, -0.030245822, -0.016523944, 0.00704637, -0.006304647, 0.0077983947, 0.012032398, -0.030596081, -0.023982381, -0.034119267, 0.01982049, -0.023899969, -0.0077005285, -0.0011228864, -0.012094208, -0.009518781, 0.03335694, 0.011414295, -0.0053105317, 0.025445225, 0.03317151, 0.0065673403, 0.017997088, 0.019645361, -0.0331097, -0.011537916, -0.012176622, -0.023199452, 0.00722665, -0.0067064133, -0.00807139, 0.04499787, 0.027855825, -0.015246532, -0.048129592, 0.0258985, -0.0013598258, -0.0019908056, 0.014999291, 0.021242127, 0.013340715, -0.007005163, -0.013175888, 0.010713779, -0.009647552, 0.008632833, -0.016657867, -0.012475371, 0.0036571072, -0.027794015, -0.031111166, 0.02511557, 0.013011061, -0.022457728, 0.043143563, 0.0068815425, 1.1138724E-4, 0.049118556, 0.03970279, 0.0064849267, 0.030946339, -0.041536495, -0.013629163, -0.003239888, -0.02210747, -0.0032682177, -0.0080868425, 0.03541728, 0.02324066, 0.016637262, 0.0023784074, -0.009117014, 0.04168072, -0.004419434, -0.03758064, -0.01734808, -0.0035386377, -0.018223725, 0.017502606, -0.010827098, 0.011599726, -0.0065621897, -5.5951165E-4, 2.5545023E-4, 0.02282859, 0.021303937, 0.014257567, 0.03811633, -0.009189126, 0.021736609, -0.018522475, 0.021468764, 0.007932317, -0.0085504195, -0.012722612, 0.016348815, 0.016781487, -0.0067733745, 0.037436415, -0.030019185, 0.0052899285, -0.022395918, 0.024971345, 0.011342184, 0.028556341, -0.02668143, -0.016482737, 0.0071339346, -0.0059955954, 0.012217829, -0.010152335, -0.016606357, 0.021654196, 0.020747645, 0.01096102, -0.02439445, -0.01789407, -0.021087602, -0.0632525, 0.029318668, 0.019841095, 0.007715981, 0.011939682, -0.027011085, 0.0033326033, 0.002222594, 0.017100839, -0.010255353, 0.016359117, -0.012866836, -1.0905326E-4, 0.007365723, -0.013052267, 0.03607659, -0.033933833, -0.005125101, 0.01258869, -0.046028044, 0.015802825, 0.010033866, -0.0055320184, 0.010373822, 0.0054702084, -0.021118507, 0.018275235, 0.037354004, -0.007546003, -0.019408423, -0.038734432, 0.0051843356, -0.0052487217, 0.032615215, -0.006335552, -0.043349598, 0.027835222, -0.029009616, 0.025857294, 0.048459247, 0.010100828, -0.001686905, -0.015761618, -0.012691707, -0.025362812, 0.016235495, -0.007582059, -0.027732205, 0.0075253993, 0.043596838, -0.020788852, 0.007154538, 0.035087626 ]
    embedding: Embedding = Embedding(
        source="Testing",
        content=text,
        index="TEST",
        embeddings=embeddings
    )

    async with aiohttp.ClientSession() as session:
        async with session.post(url, json=embedding.model_dump()) as response:
            assert response.status == 200

@pytest.mark.asyncio
async def test_query_embeddings() -> None:
    url: str = f"{BASE_URL}/database"
    text: str = "What is the capital of France?"

    async with aiohttp.ClientSession() as session:
        async with session.get(url, json=EmbeddingQuery(input=text, index="TEST").model_dump()) as response:
            return_data: Dict[str, Any] = await response.json()
            assert len(return_data) > 0
